<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<title>Extrato Bancário - Modelo (WeasyPrint)</title>

<style>
  /* Page sizing for WeasyPrint */
   @page {
  size: A4;
  margin: 2cm;

  @bottom-center {
    content: "Documento emitido em {{ date_of_issue }}";
    font-size: 10px;
    color: #555;
  }
}

  /* Base */
  html, body {
    font-family: "Helvetica", "Arial", sans-serif;
    color: #111;
    font-size: 12px;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Container */
  .sheet {
    width: 100%;
    box-sizing: border-box;
  }

  header {
    text-align: left;
    margin-bottom: 10px;
  }

  .header-top {
    display: flex;
    font-size: 18px;
  }

  .image-logo {
    width:90px;
    height: 90px;
  }

  .meta {
    font-size: 11px;
    color: #333;
  }

  .account-box {
    border: 1px solid #d0d0d0;
    padding: 8px;
    border-radius: 4px;
    width: 100%;
    box-sizing: border-box;
    margin-top: 8px;
  }

  .account-row {
    display:flex;
    gap:60px;
    align-items:center;
    font-size:12px;
  }

  .summary {
    margin: 14px 0;
    display:flex;
    gap:12px;
    align-items:flex-start;
  }

  .summary .card {
    flex: 1;
    padding: 10px;
    border-radius: 6px;
    background: #f7f7f7;
    border: 1px solid #e1e1e1;
  }

  .card .title { font-size: 11px; color: #444; margin-bottom:6px; }
  .card .value { font-weight:700; font-size:16px; }

  /* Transactions list */
  .transactions {
    margin-top: 6px;
  }

  .day-block {
    margin-top: 10px;
    padding-top: 8px;
    border-top: 1px solid #e6e6e6;
  }

  .day-header {
    font-weight:700;
    font-size:11px;
    margin-bottom:3px;
  }

  table.tx-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 11px;
  }

  table.tx-table thead th {
    font-size:11px;
    color:#333;
    padding:6px 4px;
    border-bottom: 1px solid #ddd;
  }

  table.tx-table tbody td {
    padding:6px 4px;
    vertical-align: top;
    border-bottom: 1px solid #f0f0f0;
  }

  table.tx-table td.desc {
    width: 70%;
    white-space: normal;
  }

  .tx-table tbody tr:nth-child(even) {
    background-color: #f2f2f2;
  }

  table.tx-table td.amount, table.tx-table td.t-type {
    width: 15%;
    text-align: right;
    font-variant-numeric: tabular-nums;
  }
  .font-normal {
    font-weight: normal;
    color: #777;
  }
  .font-bold{
    font-weight: 600;
  }

  table th:nth-child(2), 
  table td:nth-child(2),
  table th:nth-child(3), 
  table td:nth-child(3) {
    text-align: right;
  }
  

  /* Footer */
  footer {
    margin-top: 16px;
    border-top: 1px solid #ddd;
    padding-top: 8px;
    font-size: 11px;
    color: #444;
    text-align: center;
  }

  /* Small print repeated contact */
  .contact {
    margin-top:6px;
    font-size:11px;
    color:#555;
  }

  /* For web preview */
  @media screen {
    body { background:#fff; padding: 20px; }
    .sheet { box-shadow: 0 2px 8px rgba(0,0,0,0.06); padding: 18px; }
  }

</style>
</head>
<body>
  <div class="sheet">
    <header>
      <div class="header-top">
          <div><h2>FinanceControl</h2></div>      
      </div>
        <div>
          <div style="font-weight:700; margin-bottom:6px;">{{ user }}</div>
        </div>
      <div class="account-box" aria-label="resumo da conta">
        <div class="account-row">
          <div>
            <div style="font-size:12px; color:#000;">Saldo total</div>
            <div style="font-weight:700; font-size:15px; margin-top:4px;">R$ {{ current_balance}}</div>
            <div style="font-size:11px; color:#777; margin-top:3px;">(bloqueado + disponível)</div>
          </div>
          <div style="text-align:left;">
            <div class="meta">Saldo disponível</div>
            <div style="font-weight:700; font-size:15px; margin-top:4px;">R$ {{ current_balance}}</div>
          </div>
          <div>
             <div class="meta">Saldo bloqueado</div>
            <div style="font-weight:700; font-size:15px; margin-top:4px;">R$ 0,00</div>
          </div>
        </div>
      </div>
    </header>
      {% for date, txs in grouped_transactions.items %}
        <div class="day-block">
          <div class="day-header">{{ date }}</div>
          <table class="tx-table">
            <thead>
              <tr>
                <th class="font-normal">Descrição</th>
                <th class="font-normal right">Valor</th>
                <th class="font-normal right">Método de Pagamento</th>
              </tr>
            </thead>
            <tbody>
              {% for transaction in txs %}
                <tr>
                  <td class="desc">{{ transaction.get_type_display }}: {{ transaction.description }}</td>
                  <td class="font-bold right amount"> {% if transaction.type == "expense" %}-{% endif %}R$ {{ transaction.amount }}</td>
                  <td class="font-bold right t-type">{% if transaction.transaction_method.type == "cash" %}Dinheiro{% else %}Pix{% endif %}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% endfor %}
</body>
</html>
